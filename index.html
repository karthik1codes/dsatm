<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BrightWords - Fun Learning for Every Child</title>
    <link href="https://fonts.googleapis.com/css2?family=Fredoka:wght@400;500;600;700&family=Nunito:wght@400;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="accessibility.css">
    <script src="https://accounts.google.com/gsi/client" async defer></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.min.js"></script>
    <!-- Three.js for 3D sign language animations -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script type="module">
        // Wait for THREE to be available, then load GLTFLoader
        function loadGLTFLoader() {
            if (typeof window.THREE !== 'undefined') {
                import('https://cdn.jsdelivr.net/npm/three@0.128.0/examples/jsm/loaders/GLTFLoader.js')
                    .then((module) => {
                        window.THREE.GLTFLoader = module.GLTFLoader;
                        console.log('GLTFLoader loaded successfully');
                        // Dispatch event when GLTFLoader is ready
                        window.dispatchEvent(new CustomEvent('gltfLoaderReady'));
                    })
                    .catch((error) => {
                        console.error('Failed to load GLTFLoader:', error);
                    });
            } else {
                setTimeout(loadGLTFLoader, 50);
            }
        }
        loadGLTFLoader();
    </script>
</head>
<body class="auth-locked">
    <script>
        // IMMEDIATE session check - runs synchronously right after body tag to prevent login screen flash
        (function() {
            const AUTH_STORAGE_KEY = 'brightwords_google_user';
            try {
                const cached = localStorage.getItem(AUTH_STORAGE_KEY);
                if (cached) {
                    const parsed = JSON.parse(cached);
                    if (parsed?.credential) {
                        // Session exists - check if we're on the login page and should redirect
                        const currentPath = window.location.pathname;
                        const isLoginPage = currentPath === '/' || currentPath === '/index.html' || currentPath === '/index-react.html';
                        
                        // If we're in an iframe, let parent handle redirect
                        if (window.parent !== window.self) {
                            // In iframe - unlock but let parent React Router handle navigation
                            const body = document.body;
                            if (body) {
                                body.classList.remove('auth-locked');
                                body.classList.add('authenticated');
                            }
                            
                            function setupAuthElements() {
                                const overlay = document.getElementById('authOverlay');
                                const app = document.getElementById('appContent');
                                if (overlay) {
                                    overlay.setAttribute('aria-hidden', 'true');
                                }
                                if (app) {
                                    app.removeAttribute('aria-hidden');
                                }
                            }
                            
                            if (document.readyState === 'loading') {
                                document.addEventListener('DOMContentLoaded', setupAuthElements);
                            } else {
                                setupAuthElements();
                            }
                        } else if (isLoginPage) {
                            // Not in iframe and on login page - just unlock, stay on page
                            // The page already has the home section visible
                            const body = document.body;
                            if (body) {
                                body.classList.remove('auth-locked');
                                body.classList.add('authenticated');
                            }
                            
                            function setupAuthElements() {
                                const overlay = document.getElementById('authOverlay');
                                const app = document.getElementById('appContent');
                                if (overlay) {
                                    overlay.setAttribute('aria-hidden', 'true');
                                }
                                if (app) {
                                    app.removeAttribute('aria-hidden');
                                }
                            }
                            
                            if (document.readyState === 'loading') {
                                document.addEventListener('DOMContentLoaded', setupAuthElements);
                            } else {
                                setupAuthElements();
                            }
                            return;
                        } else {
                            // Not on login page - unlock normally
                            const body = document.body;
                            if (body) {
                                body.classList.remove('auth-locked');
                                body.classList.add('authenticated');
                            }
                            
                            function setupAuthElements() {
                                const overlay = document.getElementById('authOverlay');
                                const app = document.getElementById('appContent');
                                if (overlay) {
                                    overlay.setAttribute('aria-hidden', 'true');
                                }
                                if (app) {
                                    app.removeAttribute('aria-hidden');
                                }
                            }
                            
                            if (document.readyState === 'loading') {
                                document.addEventListener('DOMContentLoaded', setupAuthElements);
                            } else {
                                setupAuthElements();
                            }
                        }
                    }
                }
            } catch (e) {
                // Silently fail - main.js will handle auth properly
            }
        })();
    </script>
    <div id="authOverlay" class="auth-overlay" role="dialog" aria-modal="true" aria-labelledby="authTitle">
        <div class="auth-card">
            <div class="auth-logo">‚ú®</div>
            <h1 id="authTitle">Welcome to BrightWords</h1>
            <p>Sign in with Google to unlock your personalized learning journey.</p>
            <div id="googleSignInButton" class="google-btn-placeholder" aria-live="polite"></div>
            <p class="auth-hint">Need a different account? Use the account switcher in the Google dialog.</p>
        </div>
    </div>

    <div id="appContent" aria-hidden="true">
        <a href="#mainContent" class="skip-link" id="skipLink" aria-describedby="keyboardHint">Skip to main content</a>
        <div id="accessibilityAnnouncement" class="sr-only" role="status" aria-live="polite" aria-atomic="true"></div>
        <div id="keyboardHint" class="sr-only">Use Tab to move between controls. Press Space or Enter to activate buttons.</div>
        <!-- Background Decorations -->
        <div class="bg-decoration" aria-hidden="true">
            <div class="cloud cloud1"></div>
            <div class="cloud cloud2"></div>
            <div class="shape shape-circle"></div>
            <div class="shape shape-triangle"></div>
        </div>

        <!-- Main Container -->
        <div class="main-container">
        <!-- Navigation Header -->
        <header class="site-header" role="banner">
            <nav class="nav-header" role="navigation" aria-label="Primary navigation">
                <div class="logo" aria-label="BrightWords home">
                    <div class="logo-icon" aria-hidden="true">‚ú®</div>
                    <span>BrightWords</span>
                </div>
                
                <div class="nav-menu" role="menubar" aria-label="Primary menu">
                    <a href="#home" class="nav-item" role="menuitem" aria-describedby="keyboardHint">Home</a>
                    <a href="#support" class="nav-item" role="menuitem" aria-describedby="keyboardHint" onclick="event.preventDefault(); startLearning();">Learn</a>
                    <a href="#progress" class="nav-item" role="menuitem" aria-describedby="keyboardHint">Progress</a>
                    <a href="sign-language.html" class="nav-item" role="menuitem" aria-describedby="keyboardHint" title="Sign Language Learning">ü§ü Sign Language</a>
                    <a href="#parents" class="nav-item" role="menuitem" aria-describedby="keyboardHint" onclick="openParentsCommunity(event)">Parents</a>
                    <a href="#feedback" class="nav-item" role="menuitem" aria-describedby="keyboardHint">Feedback</a>
                    <a href="/aws-augmentability-main/index.html" class="nav-item superpower-link-bypass" role="menuitem" aria-describedby="keyboardHint" title="SuperPower - AWS AugmentAbility features" id="superpower-link">‚ö° SuperPower</a>
                </div>

                <div class="user-section" aria-label="User quick actions">
                    <div class="streak-badge" aria-label="Current streak">
                        üî• <span id="streakCount">0</span> Day Streak!
                    </div>
                    <div class="accessibility-controls">
                        <button type="button"
                                id="accessibilityToggle"
                                class="accessibility-toggle"
                                aria-pressed="false"
                                aria-describedby="keyboardHint accessibilityHint">
                            ‚ôø Accessibility Mode
                        </button>
                    </div>
                    <div class="avatar"
                         role="button"
                         tabindex="0"
                         aria-label="Open settings"
                         onclick="toggleSettings()"
                         onkeypress="if(event.key==='Enter' || event.key===' '){toggleSettings(); event.preventDefault();}">
                        üë§
                    </div>
                        <div class="user-auth">
                            <span id="userGreeting" class="user-greeting" aria-live="polite"></span>
                            <button type="button" id="signOutBtn" class="signout-btn" hidden>
                                Sign out
                            </button>
                        </div>
                </div>
            </nav>
        </header>
        <p id="accessibilityHint" class="sr-only">Switch to a high-contrast, dyslexia-friendly view.</p>

        <!-- Main Content -->
        <main id="mainContent" role="main" tabindex="-1">
        <!-- Hero Section -->
        <section class="hero-section" id="home">
            <div class="hero-content">
                <h1 class="hero-title">
                    BrightWords makes learning feel bold, fast, and joyful.
                </h1>
                <p class="hero-description">
                    AI-powered personalized learning support for children with dyslexia and dysgraphia. Build confidence through interactive games, multisensory activities, and real-time feedback!
                </p>
                <ul class="hero-highlights" aria-label="Key benefits">
                    <li>‚ö° 5-minute missions</li>
                    <li>üéØ Personalized boosts</li>
                    <li>üß† Neuro-inclusive fun</li>
                </ul>
                <div class="cta-buttons">
                    <button class="btn-primary" onclick="startLearning()">
                        üöÄ Start Learning
                    </button>
                    <button class="btn-secondary" onclick="watchDemo()">
                        ‚ñ∂Ô∏è Watch Demo
                    </button>
                </div>
            </div>
            
            <div class="hero-visual" aria-label="Animated accessibility spotlights">
                <div class="motion-carousel" role="region" aria-label="Accessibility spotlights" aria-live="polite">
                    <div class="motion-gallery" id="motionGallery">
                    <figure class="motion-card">
                        <div class="motion-badge">Dyslexia Boost</div>
                        <img src="assets/dyslexia.svg" alt="Animated dyslexia-friendly book" class="motion-image">
                        <figcaption>
                            <h4>Color overlays keep letters steady and highlight syllables for confident reading.</h4>
                        </figcaption>
                    </figure>
                    <figure class="motion-card">
                        <div class="motion-badge">Deaf & HoH</div>
                        <img src="assets/hearing.svg" alt="Animated ear with visual sound waves" class="motion-image">
                        <figcaption>
                            <h4>Animated visual cues pulse whenever ChatGPT replies so silent learners never miss guidance.</h4>
                        </figcaption>
                    </figure>
                    <figure class="motion-card">
                        <div class="motion-badge">Blind Explorer</div>
                        <img src="assets/vision-panel.svg" alt="Child with visual impairment learning on a tablet" class="motion-image">
                        <figcaption>
                            <h4>Audio labels, tactile-friendly keyboards, and high-contrast lessons guide low-vision learners screen by screen.</h4>
                        </figcaption>
                    </figure>
                    <figure class="motion-card">
                        <div class="motion-badge">Dysgraphia Play</div>
                        <img src="assets/dysgraphia.svg" alt="Animated pencil tracing letters" class="motion-image">
                        <figcaption>
                            <h4>Guided tracing paths animate slowly to coach handwriting, spacing, and motor planning.</h4>
                        </figcaption>
                    </figure>
                    <figure class="motion-card">
                        <div class="motion-badge">Neurodiverse Calm</div>
                        <img src="assets/neurodiverse.svg" alt="Animated puzzle pieces for neurodiverse focus" class="motion-image">
                        <figcaption>
                            <h4>Soothing puzzle pulses model routines, breathing, and predictable patterns to reduce overwhelm.</h4>
                        </figcaption>
                    </figure>
                    </div>
                    <div class="motion-dots" id="motionDots" role="tablist" aria-label="Select accessibility spotlight"></div>
                </div>
            </div>
        </section>

        <!-- Accessibility Support Section -->
        <section class="accessibility-section" id="support" aria-label="Accessibility support selection">
            <div class="section-header">
                <h2 class="section-title">Choose Your Support Needs</h2>
                <p class="section-subtitle">
                    Pick a profile so we can tailor BrightWords for different accessibility needs.
                </p>
            </div>

            <div class="support-grid">
                <button class="support-card" data-category="general" onclick="selectSupportCategory('general')">
                    <div class="support-icon">üåà</div>
                    <div class="support-info">
                        <h3>General Learner</h3>
                        <p>Balanced experience with audio, visuals, and guidance.</p>
                    </div>
                </button>

                <button class="support-card" data-category="blind" onclick="selectSupportCategory('blind')">
                    <div class="support-icon">ü¶Æ</div>
                    <div class="support-info">
                        <h3>Blind / Low Vision</h3>
                        <p>Boost speech guidance, keyboard focus, and audio cues.</p>
                    </div>
                </button>

                <button class="support-card" data-category="deaf" onclick="selectSupportCategory('deaf')">
                    <div class="support-icon">ü™Ñ</div>
                    <div class="support-info">
                        <h3>Deaf / Hard of Hearing</h3>
                        <p>Focus on visual hints, captions, and haptic-friendly prompts.</p>
                    </div>
                </button>

                <button class="support-card" data-category="neurodiverse" onclick="selectSupportCategory('neurodiverse')">
                    <div class="support-icon">üß©</div>
                    <div class="support-info">
                        <h3>Games</h3>
                        <p>Fun, engaging games that make learning an adventure! Challenge yourself and level up your skills.</p>
                    </div>
                </button>
            </div>

            <div class="support-message" id="categoryMessage">
                Please select a support profile above to get started.
            </div>

            <div class="support-feature-panel" id="supportFeaturePanel" aria-live="polite">
                <div class="support-widget" style="text-align: center; padding: 40px 20px;">
                    <h3 style="color: var(--primary-purple); margin-bottom: 16px;">üëÜ Choose Your Support Profile</h3>
                    <p style="color: var(--light-text); font-size: 15px; line-height: 1.6;">
                        Select a profile above to unlock personalized learning tools and features tailored to your needs!
                    </p>
                </div>
            </div>
        </section>

        <!-- Stats Dashboard -->
        <div class="stats-container" id="progress" role="region" aria-label="Learner statistics">
            <div class="stat-card">
                <div class="stat-icon">‚≠ê</div>
                <div class="stat-value" id="totalPoints">0</div>
                <div class="stat-label">Total Points</div>
            </div>
            <div class="stat-card">
                <div class="stat-icon">üìö</div>
                <div class="stat-value" id="lessonsComplete">0</div>
                <div class="stat-label">Lessons Complete</div>
            </div>
            <div class="stat-card">
                <div class="stat-icon">üèÜ</div>
                <div class="stat-value" id="achievements">0</div>
                <div class="stat-label">Achievements</div>
            </div>
            <div class="stat-card">
                <div class="stat-icon">‚è±Ô∏è</div>
                <div class="stat-value" id="timeSpent">0m</div>
                <div class="stat-label">Time Today</div>
            </div>
        </div>

        <!-- Interactive Learning Area -->
        <div class="learning-area" id="learningArea" role="region" aria-live="polite">
            <div class="learning-header">
                <h2 class="learning-title">
                    <span id="moduleName">Phonics Fun</span>
                </h2>
                <button class="close-btn" onclick="closeLearningArea()" aria-label="Close learning area">‚úñ</button>
            </div>
            
            <div class="game-container" id="gameContainer">
                <!-- Dynamic content will be loaded here -->
            </div>
        </div>
        </main>

        <!-- Feedback Section -->
        <section class="feedback-section" id="feedback" role="region" aria-label="Feedback section">
            <div class="section-header">
                <h2 class="section-title">Give Your Feedback!</h2>
                <p class="section-subtitle">
                    Help us improve BrightWords by providing your valuable feedback. Your feedback will be used to improve the UI/UX of the website so that we can provide the best possible service to you!
                </p>
            </div>

            <div class="feedback-grid">
                <!-- Feedback Form 1: Overall Website -->
                <div class="feedback-card">
                    <div class="feedback-card-header">
                        <span class="feedback-icon">üåê</span>
                        <h3 class="feedback-card-title">Overall Website Feedback</h3>
                    </div>
                    <div class="feedback-card-body">
                        <p class="feedback-card-description">
                            Tell us what you think about the overall website design. Rate our webpage on various metrics like satisfaction, appearance, usability, and accessibility features.
                        </p>
                        <button class="feedback-btn" onclick="openFeedbackForm('overall')" aria-label="Open overall website feedback form">
                            üìù Open Feedback Form
                        </button>
                    </div>
                </div>

                <!-- Feedback Form 2: Learning Activities -->
                <div class="feedback-card">
                    <div class="feedback-card-header">
                        <span class="feedback-icon">üéÆ</span>
                        <h3 class="feedback-card-title">Learning Activities Feedback</h3>
                    </div>
                    <div class="feedback-card-body">
                        <p class="feedback-card-description">
                            Share your experience with our learning activities (Phonics Fun, Spelling Wizard, Story Explorer, Memory Master). Help us improve the educational content and gameplay.
                        </p>
                        <button class="feedback-btn" onclick="openFeedbackForm('activities')" aria-label="Open learning activities feedback form">
                            üìù Open Feedback Form
                        </button>
                    </div>
                </div>

                <!-- Feedback Form 3: Accessibility Features -->
                <div class="feedback-card">
                    <div class="feedback-card-header">
                        <span class="feedback-icon">‚ôø</span>
                        <h3 class="feedback-card-title">Accessibility Features Feedback</h3>
                    </div>
                    <div class="feedback-card-body">
                        <p class="feedback-card-description">
                            Help us improve our accessibility features. Tell us how well the support profiles (Blind/Low Vision, Deaf/Hard of Hearing, Games) work for you and what we can improve.
                        </p>
                        <button class="feedback-btn" onclick="openFeedbackForm('accessibility')" aria-label="Open accessibility features feedback form">
                            üìù Open Feedback Form
                        </button>
                    </div>
                </div>

                <!-- Feedback Form 4: User Experience -->
                <div class="feedback-card">
                    <div class="feedback-card-header">
                        <span class="feedback-icon">‚ú®</span>
                        <h3 class="feedback-card-title">User Experience Feedback</h3>
                    </div>
                    <div class="feedback-card-body">
                        <p class="feedback-card-description">
                            Share your thoughts on the user experience, navigation, ease of use, and overall satisfaction with BrightWords. Your input helps us create a better learning platform.
                        </p>
                        <button class="feedback-btn" onclick="openFeedbackForm('ux')" aria-label="Open user experience feedback form">
                            üìù Open Feedback Form
                        </button>
                    </div>
                </div>

                <!-- Feedback Form 5: New Features & Suggestions -->
                <div class="feedback-card">
                    <div class="feedback-card-header">
                        <span class="feedback-icon">üí°</span>
                        <h3 class="feedback-card-title">Feature Suggestions</h3>
                    </div>
                    <div class="feedback-card-body">
                        <p class="feedback-card-description">
                            Have ideas for new features or improvements? Let us know what features you'd like to see added to BrightWords to make learning even better!
                        </p>
                        <button class="feedback-btn" onclick="openFeedbackForm('features')" aria-label="Open feature suggestions feedback form">
                            üìù Open Feedback Form
                        </button>
                    </div>
                </div>
            </div>
        </section>
    </div>

    <!-- Settings Panel -->
    <aside class="settings-panel" id="settingsPanel" role="complementary" aria-label="User settings" data-focus-trap="open">
        <div class="settings-header">
            <h3 class="settings-title">‚öôÔ∏è Settings</h3>
            <button class="close-btn" onclick="toggleSettings()" aria-label="Close settings panel">‚úñ</button>
        </div>
        <div class="user-profile-card" id="userProfileCard" aria-live="polite" hidden>
            <div class="user-profile-avatar" id="userProfileAvatar" aria-hidden="true">üë§</div>
            <div class="user-profile-info">
                <p class="user-profile-name" id="userProfileName">Guest Explorer</p>
                <p class="user-profile-email" id="userProfileEmail">Sign in to personalize BrightWords.</p>
            </div>
        </div>
        
        <div class="setting-item">
            <div class="setting-label">
                <span>üîä Text-to-Speech</span>
                <div class="toggle-switch active" id="ttsToggle">
                    <div class="toggle-slider"></div>
                </div>
            </div>
        </div>

        <div class="setting-item">
            <div class="setting-label">
                <span>üí° Visual Hints</span>
                <div class="toggle-switch active" id="hintsToggle">
                    <div class="toggle-slider"></div>
                </div>
            </div>
        </div>

        <div class="setting-item">
            <div class="setting-label">
                <span>üéµ Sound Effects</span>
                <div class="toggle-switch active" id="soundToggle">
                    <div class="toggle-slider"></div>
                </div>
            </div>
        </div>

        <div class="setting-item">
            <div class="setting-label">
                <span>üìä Difficulty Level</span>
            </div>
            <select id="difficultySelect" style="width: 100%; padding: 10px; border-radius: 10px; border: 2px solid #E5E7EB;">
                <option value="easy">Easy</option>
                <option value="medium">Medium</option>
                <option value="hard">Hard</option>
            </select>
        </div>
    </aside>

    <!-- Achievement Popup -->
    <div class="achievement-popup" id="achievementPopup" role="dialog" aria-modal="true" aria-labelledby="achievementTitle" data-focus-trap="show">
        <div class="achievement-icon">üèÜ</div>
        <h3 class="achievement-title" id="achievementTitle">Amazing!</h3>
        <p class="achievement-desc" id="achievementDesc">You've earned a new achievement!</p>
        <button class="btn-primary" onclick="closeAchievement()" aria-label="Close achievement popup">Continue</button>
    </div>

        <footer class="site-footer" role="contentinfo" aria-label="Site footer">
            <p>BrightWords ‚Ä¢ Inclusive learning for every child.</p>
            <p>All Rights Reserved</p>
        </footer>

        <script src="main.js"></script>
        <script src="accessibility.js"></script>
        <script>
            // SuperPower navigation - redirect in same window
            (function() {
                function setupSuperPowerLink() {
                    const superPowerLink = document.getElementById('superpower-link');
                    if (superPowerLink) {
                        // Force enable pointer events and visibility
                        superPowerLink.style.pointerEvents = 'auto';
                        superPowerLink.style.opacity = '1';
                        superPowerLink.style.position = 'relative';
                        superPowerLink.style.zIndex = '10000';
                        
                        // Remove any existing handlers by cloning
                        const newLink = superPowerLink.cloneNode(true);
                        superPowerLink.parentNode.replaceChild(newLink, superPowerLink);
                        
                        // Add click handler to redirect in same window
                        newLink.addEventListener('click', function(e) {
                            e.preventDefault();
                            e.stopPropagation();
                            // Redirect in same window to SuperPower login page
                            window.location.href = '/aws-augmentability-main/index.html';
                            return false;
                        });
                        
                        console.log('SuperPower link configured for same-window redirect');
                    }
                }
                
                // Setup immediately and on DOM ready
                if (document.readyState === 'loading') {
                    document.addEventListener('DOMContentLoaded', setupSuperPowerLink);
                } else {
                    setupSuperPowerLink();
                }
                
                // Also setup after a delay to ensure it's processed
                setTimeout(setupSuperPowerLink, 100);
                setTimeout(setupSuperPowerLink, 500);
            })();
        </script>
    </div>
</body>
</html>


